{{- $pageCfg := dict
  "isHome"    .IsHome
  "isPage"    .IsPage
  "comments"  (.Params.comments | default .Site.Params.comments.enable)
  "permalink" (.Page.Permalink | absURL)
  "path"      (.Page.Permalink | path.Base)
  "title"     .Page.Title
-}}

{{/* Append mermaid plugin */}}
{{ if .Params.mermaid }}
{{ $mermaid := dict
  "js"  .Site.Data.resources.plugins.mermaid.js
}}
{{ $pageCfg = merge $pageCfg (dict "mermaid" $mermaid) }}
{{ end }}

{{/* Append math render plugin */}}
{{ with or .Params.math .Site.Params.math }}
{{ $math := dict
  "render" .
  "js"  (index $.Site.Data.resources.plugins .).js
}}

{{ if eq . "katex" }}
  {{ $math = merge $math ( dict "css" $.Site.Data.resources.plugins.katex.css ) }}
{{ end }}

{{ $pageCfg = merge $pageCfg (dict "math" $math) }}
{{ end }}

<script class="next-config" data-name="page" type="application/json">{{- $pageCfg -}}</script>